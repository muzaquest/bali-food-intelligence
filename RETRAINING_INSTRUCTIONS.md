# üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–Æ –ú–û–î–ï–õ–ò

## ‚úÖ –í–°–ï –ì–û–¢–û–í–û –î–õ–Ø –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–Ø!

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è data leakage –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å —Å –Ω–æ–≤—ã–º–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.

## üìã –ß–¢–û –ù–£–ñ–ù–û –û–¢ –í–ê–°:

### **–í–ê–†–ò–ê–ù–¢ 1: –ü—Ä–æ—Å—Ç–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

**–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –æ–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç:**

```bash
python retrain_model.py
```

**–≠—Ç–æ —Å–¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∏—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `data/database.sqlite`
- ‚úÖ –°–æ–∑–¥–∞—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (–±–µ–∑ data leakage)
- ‚úÖ –û–±—É—á–∏—Ç –º–æ–¥–µ–ª—å Random Forest
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç –º–æ–¥–µ–ª—å –≤ `models/client_sales_model.joblib`
- ‚úÖ –ü–æ–∫–∞–∂–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ –∏ –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

### **–í–ê–†–ò–ê–ù–¢ 2: –ß–µ—Ä–µ–∑ –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

```bash
python main.py train --model-type random_forest --optimize
```

### **–í–ê–†–ò–ê–ù–¢ 3: –î—Ä—É–≥–∏–µ —Ç–∏–ø—ã –º–æ–¥–µ–ª–µ–π**

```bash
# XGBoost (–º–æ–∂–µ—Ç –±—ã—Ç—å –ª—É—á—à–µ –¥–ª—è –≤–∞—à–µ–π –∑–∞–¥–∞—á–∏)
python main.py train --model-type xgboost --optimize

# –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (–±—ã—Å—Ç—Ä–æ, –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ)
python main.py train --model-type linear --optimize
```

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:

### **–î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (—Å data leakage):**
- ‚ùå R¬≤ = 0.99+ (–ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ)
- ‚ùå –ú–æ–¥–µ–ª—å "–≤–∏–¥–µ–ª–∞" –±—É–¥—É—â–µ–µ

### **–ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ R¬≤ = 0.3-0.7 (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ)
- ‚úÖ MAE = 50-200 (—Ä–∞–∑—É–º–Ω–∞—è –æ—à–∏–±–∫–∞)
- ‚úÖ –ú–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ—à–ª–æ–µ

## üîç –ö–ê–ö –ò–ù–¢–ï–†–ü–†–ï–¢–ò–†–û–í–ê–¢–¨ –†–ï–ó–£–õ–¨–¢–ê–¢–´:

### **–ï—Å–ª–∏ R¬≤ > 0.95:**
‚ö†Ô∏è **–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û** - –≤–æ–∑–º–æ–∂–Ω–∞ –æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### **–ï—Å–ª–∏ R¬≤ = 0.6-0.8:**
‚úÖ **–û–¢–õ–ò–ß–ù–û** - –º–æ–¥–µ–ª—å —Ç–æ—á–Ω–∞—è –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è

### **–ï—Å–ª–∏ R¬≤ = 0.3-0.6:**
‚úÖ **–•–û–†–û–®–û** - –º–æ–¥–µ–ª—å –ø–æ–ª–µ–∑–Ω–∞—è, –≤—ã—è–≤–ª—è–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### **–ï—Å–ª–∏ R¬≤ < 0.3:**
‚ö†Ô∏è **–ù–ò–ó–ö–û** - –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

## üéØ –í–ê–ñ–ù–´–ï –ü–†–ò–ó–ù–ê–ö–ò (–æ–∂–∏–¥–∞–µ–º—ã–µ):

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∞–º—ã–º–∏ –≤–∞–∂–Ω—ã–º–∏ –¥–æ–ª–∂–Ω—ã —Å—Ç–∞—Ç—å:
1. **–õ–∞–≥–æ–≤—ã–µ –ø—Ä–æ–¥–∞–∂–∏** (`lag_1_sales`, `lag_2_sales`)
2. **–†–µ–π—Ç–∏–Ω–≥** (`rating`)
3. **–†–µ–∫–ª–∞–º–∞** (`ads_on`, `roas`)
4. **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** (`cancel_rate`, `position`)
5. **–í–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã** (`is_holiday`, `temp_c`)

## üö® –ö–†–ê–°–ù–´–ï –§–õ–ê–ì–ò:

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è:
- ‚ùå R¬≤ > 0.95 ‚Üí –í–æ–∑–º–æ–∂–Ω–∞ —É—Ç–µ—á–∫–∞
- ‚ùå `delta_sales_prev` - —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ ‚Üí –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥
- ‚ùå –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –±–ª–∏–∑–∫–∏ –∫ 1.0 ‚Üí –ü—Ä–æ–±–ª–µ–º–∞

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ö–ê–ß–ï–°–¢–í–ê:

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç:
```bash
cd tests
python -m pytest test_feature_engineering.py -v
```

–î–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ –±–µ–∑ –æ—à–∏–±–æ–∫.

## üîß –¢–†–ï–ë–û–í–ê–ù–ò–Ø:

**–í–°–ï –£–ñ–ï –£–°–¢–ê–ù–û–í–õ–ï–ù–û!**
- ‚úÖ –î–∞–Ω–Ω—ã–µ: `data/database.sqlite` (4MB)
- ‚úÖ –ö–æ–¥ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω: `feature_engineering.py`
- ‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `requirements.txt`
- ‚úÖ –¢–µ—Å—Ç—ã: `tests/test_*.py`

## üíª –ü–†–û–°–¢–ï–ô–®–ò–ô –°–ü–û–°–û–ë:

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ:**

```bash
python retrain_model.py
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** 2-5 –º–∏–Ω—É—Ç

**–í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç:**
- üìä –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (R¬≤, MAE, RMSE)
- üîç –¢–æ–ø-10 –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- ‚úÖ –ü—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- üí° –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üéâ –ü–û–°–õ–ï –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–Ø:

1. ‚úÖ **–ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**
2. ‚úÖ **–í—Å–µ –∫–æ–º–∞–Ω–¥—ã `main.py` –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å** —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é
3. ‚úÖ **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å—Ç–∞–Ω—É—Ç —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º–∏**
4. ‚úÖ **Data leakage –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞**

## ‚ùì –í–û–ó–ú–û–ñ–ù–´–ï –í–û–ü–†–û–°–´:

**Q: –ù—É–∂–Ω–æ –ª–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å —á—Ç–æ-—Ç–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ?**
A: –ù–µ—Ç, –≤—Å–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ.

**Q: –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–π–º–µ—Ç?**
A: 2-5 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∂–µ–ª–µ–∑–∞.

**Q: –ß—Ç–æ –µ—Å–ª–∏ R¬≤ –±—É–¥–µ—Ç –Ω–∏–∑–∫–∏–º?**
A: –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –∏ –æ–∂–∏–¥–∞–µ–º–æ –ø–æ—Å–ª–µ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —É—Ç–µ—á–∫–∏.

**Q: –°–ª–æ–º–∞–µ—Ç—Å—è –ª–∏ —á—Ç–æ-—Ç–æ –≤ –∫–æ–¥–µ?**
A: –ù–µ—Ç, –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–º–∏.

---

## üöÄ –ì–û–¢–û–í–´? –ü–†–û–°–¢–û –ó–ê–ü–£–°–¢–ò–¢–ï:

```bash
python retrain_model.py
```

**–ò –ì–û–¢–û–í–û!** üéâ