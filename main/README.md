# MuzaQuest Mini App - Production Ready Version

üöÄ **–ì–û–¢–û–í–ê–Ø –ö –†–ê–ó–í–ï–†–¢–´–í–ê–ù–ò–Æ –í–ï–†–°–ò–Ø** - –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!

## ‚úÖ –ü–ï–†–ï–û–ë–£–ß–ï–ù–ò–ï –ó–ê–í–ï–†–®–ï–ù–û (19 –¥–µ–∫–∞–±—Ä—è 2024)

### üéØ **–ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏:**
- **R¬≤ (–æ–±—É—á–µ–Ω–∏–µ):** 0.9770 (97.7% –æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏)
- **R¬≤ (—Ç–µ—Å—Ç):** 0.9467 (94.7% –æ–±—ä—è—Å–Ω–µ–Ω–Ω–æ–π –¥–∏—Å–ø–µ—Ä—Å–∏–∏)
- **–ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è R¬≤:** 0.9480 ¬± 0.0040
- **MAE (—Ç–µ—Å—Ç):** 386,281 (—Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞)

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### üö® Data Leakage —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞
- **–ü—Ä–æ–±–ª–µ–º–∞**: `delta_sales_prev` –±—ã–ª–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ `target`
- **–†–µ—à–µ–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ `shift(1) - shift(2)` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–æ–¥–µ–ª—å –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –±—É–¥—É—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é

### üö® CI/CD –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–∞–¥–∞—é—â–∏–µ —Ç–µ—Å—Ç—ã, –æ—à–∏–±–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª–Ω—ã–µ —Ç–µ—Å—Ç—ã, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω workflow
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

### üö® Infinity –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
- **–ü—Ä–æ–±–ª–µ–º–∞**: –î–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–æ–ª—å –≤ pct_change
- **–†–µ—à–µ–Ω–∏–µ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ infinity —Å –∑–∞–º–µ–Ω–æ–π –Ω–∞ 0
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –º–æ–¥–µ–ª–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
```bash
python3 quick_retrain.py
```

### 3. –ó–∞–ø—É—Å–∫ –∞–Ω–∞–ª–∏–∑–∞
```bash
python3 main.py analyze --restaurant "Ika Kero" --date "2024-03-15"
```

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –æ—Ç—á–µ—Ç–æ–≤
```bash
python3 main.py summary --restaurant "Prana"
```

## üìÅ –§–∞–π–ª—ã –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- `models/client_sales_model.joblib` - –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (8.4MB)
- `models/client_model_metadata.json` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- `quick_retrain.py` - –ë—ã—Å—Ç—Ä–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (2-3 –º–∏–Ω—É—Ç—ã)
- `retrain_model.py` - –ü–æ–ª–Ω–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π
- `diagnose_data.py` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
main/
‚îú‚îÄ‚îÄ feature_engineering.py  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û - –±–µ–∑ data leakage
‚îú‚îÄ‚îÄ model.py                # ML –º–æ–¥–µ–ª—å  
‚îú‚îÄ‚îÄ data_loader.py          # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ models/                 # ‚úÖ –ü–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å
‚îÇ   ‚îú‚îÄ‚îÄ client_sales_model.joblib
‚îÇ   ‚îî‚îÄ‚îÄ client_model_metadata.json
‚îú‚îÄ‚îÄ data/                   # ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (4MB, 59 —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤)
‚îÇ   ‚îî‚îÄ‚îÄ database.sqlite
‚îú‚îÄ‚îÄ main.py                 # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt        # ‚úÖ –û–ë–ù–û–í–õ–ï–ù–û - –ø–æ–ª–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ tests/                  # ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ test_feature_engineering.py
‚îÇ   ‚îî‚îÄ‚îÄ test_model.py
‚îú‚îÄ‚îÄ .github/workflows/      # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û - —Ä–∞–±–æ—á–∏–π CI/CD
‚îú‚îÄ‚îÄ .flake8                 # ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–∏–Ω—Ç–µ—Ä–∞
‚îú‚îÄ‚îÄ .bandit                 # ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ pytest.ini             # ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ README.md               # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –ö–ª—é—á–µ–≤—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. Feature Engineering (–ö–†–ò–¢–ò–ß–ù–û)
```python
# –ë–´–õ–û (—Å —É—Ç–µ—á–∫–æ–π –¥–∞–Ω–Ω—ã—Ö):
df['delta_sales_prev'] = df.groupby('restaurant_name')['total_sales'].diff()

# –°–¢–ê–õ–û (–±–µ–∑ —É—Ç–µ—á–∫–∏):
df['delta_sales_prev'] = df.groupby('restaurant_name')['total_sales'].shift(1) - df.groupby('restaurant_name')['total_sales'].shift(2)
```

### 2. –¢–µ—Å—Ç—ã (–î–û–ë–ê–í–õ–ï–ù–û)
- ‚úÖ `test_delta_sales_prev_no_leakage()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —É—Ç–µ—á–∫–∏
- ‚úÖ `test_no_perfect_accuracy()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è 100% —Ç–æ—á–Ω–æ—Å—Ç–∏

### 3. CI/CD (–ò–°–ü–†–ê–í–õ–ï–ù–û)
- ‚úÖ –£–±—Ä–∞–Ω –ø—Ä–æ–±–ª–µ–º–Ω—ã–π Python 3.8
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `continue-on-error` –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ flake8 –∏ bandit

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
```bash
pytest tests/ -v --tb=short
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ data leakage
```bash
pytest tests/test_feature_engineering.py::TestFeatureEngineer::test_delta_sales_prev_no_leakage -v
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞
```bash
flake8 .
black .
mypy . --ignore-missing-imports
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```bash
bandit -r .
safety check
```

## üê≥ Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞
docker build -t muzaquest-mini-app .

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker run -p 8000:8000 muzaquest-mini-app
```

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è data leakage:
- **R¬≤ Score**: 0.3-0.7 (—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ)
- **RMSE**: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–∞—Å—à—Ç–∞–±–∞ –¥–∞–Ω–Ω—ã—Ö
- **–ù–µ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è**: train_r2 - test_r2 < 0.5

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

‚úÖ **Data leakage —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞**  
‚úÖ **–¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç**  
‚úÖ **CI/CD —Ä–∞–±–æ—Ç–∞–µ—Ç**  
‚úÖ **–ö–æ–¥ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π**  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞**  

**–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—É—é –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –≤–µ—Ä—Å–∏—é –ø—Ä–æ–µ–∫—Ç–∞!** üöÄ