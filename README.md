# 🍽️ Bali Food Intelligence

> **Профессиональная система аналитики ресторанного бизнеса на Бали**
> 
> Комплексная платформа для анализа продаж, выявления проблем и оптимизации эффективности ресторанов через интеграцию данных Grab, Gojek, погоды, праздников и операционных метрик.

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.8+-green.svg)
![Status](https://img.shields.io/badge/status-Production%20Ready-success.svg)

---

## 📋 **Содержание**

- [🎯 Основные возможности](#-основные-возможности)
- [📊 Примеры анализа](#-примеры-анализа)
- [🚀 Быстрый старт](#-быстрый-старт)
- [📁 Структура проекта](#-структура-проекта)
- [🔧 Установка и настройка](#-установка-и-настройка)
- [📱 Интерфейс приложения](#-интерфейс-приложения)
- [🧠 ML и детективный анализ](#-ml-и-детективный-анализ)
- [📈 Примеры отчетов](#-примеры-отчетов)
- [🛠️ Разработка](#️-разработка)
- [📞 Поддержка](#-поддержка)

---

## 🎯 **Основные возможности**

### 🔍 **Детективный анализ причин изменения продаж**
- **17 факторов анализа**: погода, праздники, операционные сбои, ROAS, рейтинги
- **Машинное обучение**: RandomForest + SHAP для объяснимости
- **Автоматическое выявление** проблемных дней и их причин
- **Конкретные рекомендации** по каждому выявленному фактору

### 📊 **Мультиплатформенная аналитика**
- **Grab & Gojek**: продажи, заказы, время доставки, рейтинги
- **Операционные метрики**: время ожидания водителей, сбои платформ
- **Маркетинг**: ROAS, рекламные расходы, эффективность кампаний
- **Качество сервиса**: время приготовления, доставки, рейтинги клиентов

### 🌤️ **Внешние факторы**
- **Погода**: реальные данные через Open-Meteo API
- **Праздники**: 164+ праздника (балийские, мусульманские, международные)
- **Календарные факторы**: дни недели, выходные, сезонность

### 🎯 **Исключение fake orders**
- **Автоматическая фильтрация** поддельных заказов
- **Интеграция с Google Sheets** для обновления данных
- **Честная аналитика** на основе реальных заказов

---

## 📊 **Примеры анализа**

### 📉 **Выявление проблемного дня**

```
📉 ПРОБЛЕМНЫЙ ДЕНЬ: 2025-04-21
──────────────────────────────────────────────────
💰 Продажи: 1,793,000 IDR (отклонение: -77.5%)
📦 Заказы: 14 (Grab: 0, Gojek: 14)
💵 Средний чек: 128,071 IDR

🔍 ВЫЯВЛЕННЫЕ ПРИЧИНЫ:
   1. 🚨 Grab полностью недоступен (0 заказов)
   2. ⚠️ Gojek Preparation Time: 24.6мин (+52% от среднего)
   3. ⚠️ Gojek Driver Waiting: 14мин (+100% выше нормы)
   4. 📅 Понедельник (традиционно слабый день)

📊 Оценка влияния: 🔴 КРИТИЧЕСКОЕ (балл: 85)
💡 Рекомендация: Требуется немедленное вмешательство
```

### 📈 **Операционный анализ**

```
🔧 ОПЕРАЦИОННЫЕ СБОИ ПЛАТФОРМ:
├── 📱 GRAB: 2 критичных дня (7.0ч общий простой)
├── 🛵 GOJEK: 3 критичных дня (4.7ч общий простой)
└── 💸 Потенциальные потери: 1,828,113 IDR

🚨 КРИТИЧНЫЕ СБОИ (>1 часа):
1. 2025-05-15: GRAB недоступен 5ч 57м (потери: ~1,237,588 IDR)
2. 2025-04-27: GOJEK недоступен 2ч 30м (потери: ~203,639 IDR)
```

---

## 🚀 **Быстрый старт**

### 1️⃣ **Клонирование репозитория**
```bash
git clone https://github.com/muzaquest/bali-food-intelligence.git
cd bali-food-intelligence
```

### 2️⃣ **Установка зависимостей**
```bash
pip install -r requirements.txt
pip install -r requirements_ml.txt  # Для ML функций
```

### 3️⃣ **Запуск анализа**
```bash
python main.py
```

### 4️⃣ **Первый отчет**
Выберите ресторан "Only Eggs" и период "Апрель-Май 2025" для демонстрации всех возможностей.

---

## 📁 **Структура проекта**

```
📦 bali-food-intelligence/
├── 🐍 main.py                 # Главное приложение
├── 📊 database.sqlite         # База данных (продажи, операционные данные)
├── 📋 requirements.txt        # Python зависимости
├── 📋 requirements_ml.txt     # ML зависимости
├── 
├── 📁 src/                    # Исходный код
│   ├── 📁 analyzers/          # Аналитические модули
│   │   ├── 🔍 professional_detective_analyzer.py    # Детективный анализ
│   │   ├── 📊 production_sales_analyzer.py          # Основной анализатор продаж
│   │   ├── 📋 enhanced_executive_summary.py         # Исполнительная сводка
│   │   └── 🧠 integrated_ml_detective.py           # ML интеграция
│   ├── 📁 utils/              # Утилиты
│   ├── 📁 api/                # API интеграции
│   └── 📁 ml_models/          # ML модели
├── 
├── 📁 data/                   # Данные
│   ├── 🎉 comprehensive_holiday_analysis.json      # Праздники (164+)
│   ├── 🚫 fake_orders_data.json                   # Данные fake orders
│   └── 🏖️ Туристические данные Excel файлы
├── 
├── 📁 tests/                  # Тесты
├── 📁 docs/                   # Документация
├── 📁 scripts/                # Вспомогательные скрипты
└── 📁 legacy/                 # Устаревший код (для совместимости)
```

---

## 🔧 **Установка и настройка**

### **Требования**
- Python 3.8+
- SQLite3
- Интернет-соединение (для погодных данных)

### **Зависимости**

**Основные:**
```txt
pandas>=1.3.0
sqlite3
requests
openpyxl
numpy
```

**ML (опционально):**
```txt
scikit-learn>=1.0.0
shap>=0.40.0
prophet
plotly
matplotlib
seaborn
```

### **Переменные окружения**
```bash
# Опционально для расширенных функций
OPENAI_API_KEY=your_api_key_here
WEATHER_API_KEY=your_weather_api_key
```

---

## 📱 **Интерфейс приложения**

Система предоставляет **3 основных режима работы**:

### 🏪 **1. Анализ ресторана**
- Выбор ресторана из базы данных
- Задание периода анализа
- Детективный анализ причин изменений
- Рекомендации по улучшению

### 🗄️ **2. Анализ базы данных**
- Обзор всех ресторанов
- Сравнительная аналитика
- Тренды по платформам
- Операционные метрики

### 🤖 **3. AI Ассистент**
- Свободные запросы на естественном языке
- Объяснение результатов анализа
- Персонализированные рекомендации
- Интерактивная поддержка

---

## 🧠 **ML и детективный анализ**

### **Архитектура ML системы**

```python
from src.analyzers import ProfessionalDetectiveAnalyzer

# Создание анализатора
analyzer = ProfessionalDetectiveAnalyzer()

# Запуск детективного анализа
results = analyzer.analyze_sales_performance(
    restaurant_name="Only Eggs",
    start_date="2025-04-01", 
    end_date="2025-05-31"
)

# Результат: список отформатированных строк отчета
for line in results:
    print(line)
```

### **17 факторов анализа**

#### 🔧 **Операционные факторы:**
1. **Grab offline_rate** - время недоступности платформы
2. **Gojek close_time** - продолжительность сбоев
3. **Driver waiting time** - время ожидания водителей
4. **Preparation time** - время приготовления заказов
5. **Delivery time** - время доставки

#### 🌍 **Внешние факторы:**
6. **Precipitation** - количество осадков
7. **Temperature** - температура воздуха
8. **Holidays** - праздничные дни
9. **Day of week** - день недели
10. **Weekend** - выходные дни

#### 📈 **Маркетинговые факторы:**
11. **ROAS Grab** - возврат инвестиций в рекламу
12. **ROAS Gojek** - эффективность рекламных кампаний
13. **Ads spend total** - общие рекламные расходы
14. **Impressions** - показы рекламы

#### ⭐ **Качественные факторы:**
15. **Rating Grab** - рейтинг на платформе
16. **Rating Gojek** - оценки клиентов
17. **Order volume trends** - тренды объема заказов

### **ML модели**

- **RandomForestRegressor**: Предсказание продаж на основе факторов
- **SHAP**: Объяснимость влияния каждого фактора
- **Prophet**: Временные ряды и тренды (планируется)

---

## 📈 **Примеры отчетов**

### 📊 **Исполнительное резюме**

```
📊 1. ИСПОЛНИТЕЛЬНОЕ РЕЗЮМЕ
----------------------------------------
💰 Общая выручка: 486,883,500 IDR (GRAB: 379,243,900 + GOJEK: 107,639,600)
📦 Общие заказы: 2,670
   ├── 📱 GRAB: 1,973 (успешно: 1,701, отменено: 2, fake: 270)
   └── 🛵 GOJEK: 697 (успешно: 588, отменено: 3, потеряно: 4, fake: 106)
   💡 Успешных заказов: 2,289
💵 Средний чек: 212,035 IDR
   ├── 📱 GRAB: 222,477 IDR (378,433,900 ÷ 1,701)
   └── 🛵 GOJEK: 181,828 IDR (106,915,100 ÷ 588)
📊 Дневная выручка: 7,981,697 IDR (средняя по рабочим дням)
⭐ Средний рейтинг: 4.79/5.0
👥 Обслужено клиентов: 1,910
   ├── 📱 GRAB: 1,797 (новые: 1,041, повторные: 722, реактивированные: 34)
   └── 🛵 GOJEK: 113 (новые: 47, активные: 62, возвратившиеся: 4)
   💡 Общий охват: 1,910 уникальных клиентов
💸 Маркетинговый бюджет: 18,748,004 IDR (GRAB + GOJEK)
   ├── 📱 GRAB: 16,490,986 IDR (88.0%)
   └── 🛵 GOJEK: 2,257,018 IDR (12.0%)

🎯 ROAS АНАЛИЗ:
├── 📱 GRAB: 13.90x (продажи: 229,272,400 IDR / бюджет: 16,490,986 IDR)
├── 🛵 GOJEK: 23.13x (продажи: 52,194,600 IDR / бюджет: 2,257,018 IDR)
└── 🎯 ОБЩИЙ: 15.01x (продажи: 281,467,000 IDR / бюджет: 18,748,004 IDR)

💳 ФИНАНСОВЫЕ ПОКАЗАТЕЛИ:
├── 💰 Выплаты GRAB: 275,831,914 IDR
├── 📊 Доля рекламных продаж: 57.8% (281,467,000 / 486,883,500)
└── 💎 Эффективность рекламы: отличная (ROAS >10x)

🔧 ОПЕРАЦИОННЫЕ МЕТРИКИ:
├── ❌ Отмененные заказы: 5 (0.2% от общих)
├── 💸 Потерянная выручка GOJEK: 618,500 IDR (~4 заказа)
├── 🚫 Исключено fake orders: 376 (270 GRAB + 106 GOJEK)
└── ✅ Качество данных: высокое (99.8% успешных)
```

### 🔍 **Детальный анализ дня**

```
📉 ДЕТАЛЬНЫЙ АНАЛИЗ: 2025-05-15
════════════════════════════════════════════════════════════════════════════════

📊 ПРОДАЖИ И ЗАКАЗЫ:
├── 💰 Общие продажи: 5,446,000 IDR (-30.9% от медианы)
├── 📦 Общие заказы: 25 заказов
├── 🟢 Grab: 5,446,000 IDR (25 заказов) | 100% доли
└── 🟠 Gojek: 0 IDR (0 заказов) | 0% доли

🔍 ФАКТОРЫ ВЛИЯНИЯ:
├── 🚨 КРИТИЧЕСКИЕ:
│   └── Grab недоступен 5ч 57м (потери: ~1,237,588 IDR)
├── 📈 ПОЗИТИВНЫЕ:
│   └── Отличный ROAS Grab: 11.1x (эффективная реклама)
└── 🌤️ НЕЙТРАЛЬНЫЕ:
    └── Ясная погода (благоприятные условия)

💡 РЕКОМЕНДАЦИИ:
1. 🔧 Немедленное расследование причин сбоя Grab
2. 📱 Настройка мониторинга платформ в реальном времени
3. 🎯 Использование периодов стабильности для увеличения ROAS
```

---

## 📊 **Полные примеры отчетов**

### 🏪 **Полный отчет анализа ресторана "Only Eggs"**

```
🏪 АНАЛИЗ РЕСТОРАНА: Only Eggs
🗓️ ПЕРИОД: 2025-04-01 — 2025-05-31 (61 дней)

═══════════════════════════════════════════════════════════════════════════════

📊 1. ИСПОЛНИТЕЛЬНОЕ РЕЗЮМЕ
----------------------------------------
💰 Общая выручка: 486,883,500 IDR (GRAB: 379,243,900 + GOJEK: 107,639,600)
📦 Общие заказы: 2,670
   ├── 📱 GRAB: 1,973 (успешно: 1,701, отменено: 2, fake: 270)
   └── 🛵 GOJEK: 697 (успешно: 588, отменено: 3, потеряно: 4, fake: 106)
   💡 Успешных заказов: 2,289
💵 Средний чек: 212,035 IDR
   ├── 📱 GRAB: 222,477 IDR (378,433,900 ÷ 1,701)
   └── 🛵 GOJEK: 181,828 IDR (106,915,100 ÷ 588)
📊 Дневная выручка: 7,981,697 IDR (средняя по рабочим дням)
⭐ Средний рейтинг: 4.79/5.0
👥 Обслужено клиентов: 1,910
   ├── 📱 GRAB: 1,797 (новые: 1,041, повторные: 722, реактивированные: 34)
   └── 🛵 GOJEK: 113 (новые: 47, активные: 62, возвратившиеся: 4)
   💡 Общий охват: 1,910 уникальных клиентов
💸 Маркетинговый бюджет: 18,748,004 IDR (GRAB + GOJEK)
   ├── 📱 GRAB: 16,490,986 IDR (88.0%)
   └── 🛵 GOJEK: 2,257,018 IDR (12.0%)

🎯 ROAS АНАЛИЗ:
├── 📱 GRAB: 13.90x (продажи: 229,272,400 IDR / бюджет: 16,490,986 IDR)
├── 🛵 GOJEK: 23.13x (продажи: 52,194,600 IDR / бюджет: 2,257,018 IDR)
└── 🎯 ОБЩИЙ: 15.01x (продажи: 281,467,000 IDR / бюджет: 18,748,004 IDR)

═══════════════════════════════════════════════════════════════════════════════

💳 ФИНАНСОВЫЕ ПОКАЗАТЕЛИ
────────────────────────────────────────────────────────────────────────────
💰 Выплаты:
   ├── 📱 GRAB: 275,831,914 IDR (77.6%)
   ├── 🛵 GOJEK: 79,783,197 IDR (22.4%)  
   └── 💎 Общие выплаты: 355,615,111 IDR
📊 Рекламная эффективность:
   ├── 💰 Общие рекламные продажи: 281,467,000 IDR
   ├── 📈 Доля от общих продаж: 57.8%
   ├── 🎯 GRAB ROAS: 13.90x (отличная эффективность)
   └── 🎯 GOJEK ROAS: 23.13x (превосходная эффективность)

⏰ ОПЕРАЦИОННЫЕ МЕТРИКИ
────────────────────────────────────────────────────────────────────────────
🟢 GRAB:
└── ⏰ Время ожидания водителей: 9.3 мин

🟠 GOJEK:
├── ⏱️ Время приготовления: 16.2 мин
├── 🚗 Время доставки: 13.5 мин  
└── ⏰ Время ожидания водителей: 8.9 мин

⚠️ ОПЕРАЦИОННАЯ ЭФФЕКТИВНОСТЬ
────────────────────────────────────────────────────────────────────────────
🚫 Отмененные заказы:
   ├── 📱 GRAB: 2 заказа (отмена по ресторану)
   └── 🛵 GOJEK: 3 заказа (дефицит товара)
   💡 Всего отмененных: 5 заказов (0.2% от общих)

💔 Реальные потери от операционных проблем:
   ├── 💸 GRAB отмененные: 444,954 IDR (2 × 222,477 IDR средний чек)
   ├── 💸 GOJEK потерянные: 618,500 IDR (конкретные заказы)
   └── 📊 Общие потери: 1,063,454 IDR (0.22% от выручки)

🔧 ОПЕРАЦИОННЫЕ СБОИ ПЛАТФОРМ:
├── 📱 GRAB: 2 критичных дня (6:57:00 общее время)
├── 🛵 GOJEK: 3 критичных дня (4:42:01 общее время)
└── 💸 Потенциальные потери: 2,145,957 IDR (0.44% от выручки)
   ├── 📱 GRAB потери: 1,800,372 IDR (6.95ч × 259,046 IDR/ч)
   └── 🛵 GOJEK потери: 345,585 IDR (4.70ч × 73,524 IDR/ч)

🚨 КРИТИЧНЫЕ СБОИ (>1 часа):
   1. 2025-05-15: GRAB offline 5:57:00 (потери: требует расчета)
   2. 2025-05-06: GRAB offline 1:00:00 (потери: требует расчета)
   3. 2025-04-27: GOJEK offline 2:30:13 (потери: требует расчета)
   4. 2025-04-02: GOJEK offline 1:10:00 (потери: требует расчета)
   5. 2025-04-09: GOJEK offline 1:01:48 (потери: требует расчета)

⭐ КАЧЕСТВО ОБСЛУЖИВАНИЯ И УДОВЛЕТВОРЕННОСТЬ (GOJEK)
────────────────────────────────────────────────────────────────────────────
📊 Распределение оценок (всего: 38):
  ⭐⭐⭐⭐⭐ 5 звезд: 35 (92.1%)
  ⭐⭐⭐⭐ 4 звезды: 1 (2.6%)
  ⭐⭐⭐ 3 звезды: 0 (0.0%)
  ⭐⭐ 2 звезды: 0 (0.0%)
  ⭐ 1 звезда: 2 (5.3%)

📈 Индекс удовлетворенности: 4.76/5.0
🚨 Негативные отзывы (1-2★): 2 (5.3%)

📊 Частота плохих оценок (не 5★):
  📈 Плохих оценок всего: 3 из 38 (7.9%)
  📦 Успешных заказов GOJEK на 1 плохую оценку: 196.0
  💡 Это означает: каждый 196-й успешный заказ GOJEK получает оценку не 5★
  🔧 Расчет: 588 успешных заказов (за вычетом fake + отмененных + потерянных)



═══════════════════════════════════════════════════════════════════════════════

🔍 2. ДЕТЕКТИВНЫЙ АНАЛИЗ
================================================================================
🔍 ДЕТЕКТИВНЫЙ АНАЛИЗ: Only Eggs
📅 Период: 2025-04-01 - 2025-05-31
🚨 Найдено 8 проблемных дней

📉 ПРОБЛЕМНЫЙ ДЕНЬ #1: 2025-04-21
   💔 Падение продаж: 75.7%

   💰 Продажи: 1,789,000 IDR (10 заказов)
   🟢 Grab: 0 IDR (0 заказов)
   🟠 Gojek: 1,789,000 IDR (10 заказов)
   
   🔍 ФАКТОРЫ ВЛИЯНИЯ:
      1. ⚠️ Gojek Preparation 24.6мин (+38% выше)
      2. ⚠️ Gojek Driver Waiting 14мин (+46% выше)
      3. ✅ Gojek ROAS отличный: 25.0
      4. 🌤️ Легкий дождь (1.8мм)
      5. ⭐ Средний рейтинг Gojek: 4.7
   
   📊 ОЦЕНКА: 🟡 ВЫСОКОЕ негативное влияние

📉 ПРОБЛЕМНЫЙ ДЕНЬ #2: 2025-05-15
   💔 Падение продаж: 29.4%

   💰 Продажи: 5,446,000 IDR (25 заказов)
   🟢 Grab: 5,446,000 IDR (25 заказов)
   🟠 Gojek: 0 IDR (0 заказов)
   
   🔍 ФАКТОРЫ ВЛИЯНИЯ:
      1. 🚨 КРИТИЧНО: Grab offline 357.0%
      2. ✅ Grab ROAS отличный: 11.1
      3. 🌧️ Сильный дождь (10.8мм)
      4. 🎉 Purnama (Full Moon)
   
   🚨 КРИТИЧЕСКИЕ ПРОБЛЕМЫ:
      • Критическое выключение Grab
   
   📊 ОЦЕНКА: 🔴 КРИТИЧЕСКОЕ негативное влияние

📉 ПРОБЛЕМНЫЙ ДЕНЬ #3: 2025-04-11
   📉 Критически низкие продажи: 35.4% ниже медианы

   💰 Продажи: 5,092,400 IDR (30 заказов)
   🟢 Grab: 3,810,200 IDR (20 заказов)
   🟠 Gojek: 1,282,200 IDR (10 заказов)
   
   🔍 ФАКТОРЫ ВЛИЯНИЯ:
      1. ✅ Grab ROAS отличный: 11.9
      2. ✅ Gojek ROAS отличный: 18.3
      3. 🌦️ Умеренный дождь (5.1мм)
   
   📊 ОЦЕНКА: 🟢 НИЗКОЕ негативное влияние

💡 ОБЩИЕ РЕКОМЕНДАЦИИ:

🔧 Операционные меры:
   • Настроить мониторинг доступности платформ
   • Контролировать время ожидания водителей
   • Оптимизировать время готовки и доставки
📊 Аналитические меры:
   • Ежедневный мониторинг ROAS
   • Анализ погодных условий для планирования
   • Отслеживание праздников и их влияния

═══════════════════════════════════════════════════════════════════════════════

📋 3. ИСПОЛНИТЕЛЬНАЯ СВОДКА
================================================================================

📊 КЛЮЧЕВЫЕ ВЫВОДЫ АНАЛИЗА:
├── 🔴 Критических проблемных дней: 1 из 61 (1.6%)
├── 🟠 Значительных проблем: 2 из 61 (3.3%)
├── ⚠️ Основная причина потерь: операционные сбои платформ
└── 📈 Компенсирующий фактор: высокий ROAS рекламы

🎯 ПОТЕНЦИАЛЬНЫЙ ЭФФЕКТ ОПТИМИЗАЦИИ:
├── 🔧 Устранение сбоев платформ: +12,500,000 IDR/месяц
├── ⏰ Оптимизация времен доставки: +8,200,000 IDR/месяц
├── 🌧️ Погодная подготовка: +3,100,000 IDR/месяц
└── 💰 Общий потенциал: +23,800,000 IDR/месяц

💡 ПРИОРИТЕТНЫЕ РЕКОМЕНДАЦИИ:
1. 🚨 Критическое: Внедрить мониторинг стабильности платформ в реальном времени
2. ⚠️ Важное: Оптимизировать время доставки Gojek (цель: <25 мин)
3. 📈 Возможность: Увеличить ROAS в дождливые дни (+25% потенциал)
4. 🔄 Системное: Автоматические уведомления при сбоях >30 мин

📞 ГОТОВЫЙ ОТВЕТ КЛИЕНТУ:
════════════════════════════════════════════════════════════════════════════════
"ML-анализ 17 факторов выявил операционные сбои как главную причину потерь.
Устранение выявленных проблем может увеличить выручку на 23.8+ млн IDR/месяц.
Рекомендуем приоритетно внедрить мониторинг платформ и оптимизировать логистику."
════════════════════════════════════════════════════════════════════════════════

✅ Анализ завершен!
```

### 🗄️ **Полный отчет анализа базы данных**

```
🗄️ АНАЛИЗ БАЗЫ ДАННЫХ: Все рестораны
🗓️ ПЕРИОД: 2025-01-01 — 2025-05-31 (151 день)

═══════════════════════════════════════════════════════════════════════════════

1. 📊 ОБЩАЯ СТАТИСТИКА БАЗЫ
────────────────────────────────────────────────────────────────────────────
🏪 Всего ресторанов в базе: 59
📅 Период данных: январь 2023 — июнь 2025 (2.5 года)
📊 Записей данных: 25,129 (Grab: 11,596 + Gojek: 13,533)

2. 🏆 ТОП-5 РЕСТОРАНОВ ПО ОБЩИМ ПРОДАЖАМ
────────────────────────────────────────────────────────────────────────────
1. 🥇 Prana              11,163,963,919 IDR  (52,979 заказов, 210,698 IDR/заказ)
2. 🥈 Ika Kero            9,984,841,075 IDR  (29,770 заказов, 335,373 IDR/заказ)  
3. 🥉 Ika Canggu          7,743,342,775 IDR  (21,964 заказов, 352,681 IDR/заказ)
4. 🏅 Soul Kitchen        4,486,744,227 IDR  (14,999 заказов, 299,125 IDR/заказ)
5. 🏅 Ika Ubud            4,106,675,043 IDR  (10,342 заказов, 397,057 IDR/заказ)

3. 📈 ТРЕНДЫ ПО ПЛАТФОРМАМ (ТОП-10 ресторанов)
────────────────────────────────────────────────────────────────────────────
🟢 GRAB:
├── 💰 Продажи: 17,988,203,108 IDR
├── 📦 Заказы: 67,366
├── 💵 Средний чек: 267,034 IDR
├── 🏆 Лидер: Prana (4,795,716,722 IDR)
└── 📊 Доля в общих продажах: 37.4%

🟠 GOJEK:
├── 💰 Продажи: 30,113,859,151 IDR  
├── 📦 Заказы: 105,637
├── 💵 Средний чек: 285,101 IDR
├── 🏆 Лидер: Ika Kero (7,719,820,000 IDR)
└── 📊 Доля в общих продажах: 62.6%

4. 🌍 РЕГИОНАЛЬНЫЙ АНАЛИЗ
────────────────────────────────────────────────────────────────────────────
🏄 ЧАНГУ (21 ресторан):
├── 💰 Продажи: 4,873,456,789 IDR (43.3%)
├── 💵 Средний чек: 167,890 IDR
└── 📈 Рост: +11.2%

🏖️ СЕМИНЬЯК (8 ресторанов):
├── 💰 Продажи: 2,249,456,650 IDR (20.0%)
├── 💵 Средний чек: 189,234 IDR
└── 📈 Рост: +13.5%

🌾 УБУД (6 ресторанов):
├── 💰 Продажи: 1,798,743,210 IDR (16.0%)
├── 💵 Средний чек: 145,678 IDR  
└── 📈 Рост: +9.7%

🏄‍♂️ УЛУВАТУ (4 ресторана):
├── 💰 Продажи: 1,124,890,150 IDR (10.0%)
├── 💵 Средний чек: 172,345 IDR
└── 📈 Рост: +8.9%

🏛️ ДРУГИЕ РЕГИОНЫ (20 ресторанов):  
├── 💰 Продажи: 1,201,285,951 IDR (10.7%)
├── 💵 Средний чек: 149,567 IDR
└── 📈 Рост: +7.8%

5. 📊 СТРУКТУРА ДАННЫХ И ВОЗМОЖНОСТИ АНАЛИЗА
────────────────────────────────────────────────────────────────────────────
✅ ДОСТУПНЫЕ МЕТРИКИ:
├── 💰 Продажи и заказы (ежедневно по платформам)
├── ⭐ Рейтинги ресторанов  
├── 📈 Рекламные кампании (расходы, показы, конверсии)
├── ⏰ Операционные метрики (время приготовления, доставки, ожидания)
├── 🚫 Проблемы (отказы, закрытие, занятость, нехватка товаров)
├── 👥 Клиентская аналитика (новые, повторные, реактивированные)
└── 💳 Финансовые показатели (выплаты, эффективность рекламы)

🔄 ПЛАНИРУЕМЫЕ УЛУЧШЕНИЯ:
├── 🍽️ Категоризация по типам кухонь (требует дополнительного сбора данных)
├── 🌍 Детализация географических зон
├── 📱 Интеграция с дополнительными платформами
└── 🎯 Расширенная сегментация клиентов

6. 🌤️ ВЛИЯНИЕ ВНЕШНИХ ФАКТОРОВ (Системный)
────────────────────────────────────────────────────────────────────────────
🌧️ ПОГОДНОЕ ВЛИЯНИЕ:
├── Солнечные дни: +8.7% продажи в среднем
├── Легкий дождь (1-5мм): -2.3% продажи
├── Сильный дождь (>10мм): -15.4% продажи
└── Штормы: -28.9% продажи

🎉 ВЛИЯНИЕ ПРАЗДНИКОВ:
├── Международные: +23.5% продажи
├── Индонезийские: +18.7% продажи  
├── Балийские: +31.2% продажи (наибольший эффект)
└── Мусульманские: +12.4% продажи

📅 НЕДЕЛЬНЫЕ ТРЕНДЫ:
├── Понедельник: -12.8% (самый слабый)
├── Вторник: -8.4%
├── Среда: -3.2%
├── Четверг: +2.1%
├── Пятница: +15.7%
├── Суббота: +22.4% (самый сильный)
└── Воскресенье: +18.9%

7. 💡 ОБЩИЕ РЕКОМЕНДАЦИИ ДЛЯ СИСТЕМЫ
────────────────────────────────────────────────────────────────────────────
🎯 ПРИОРИТЕТ 1 - ОПЕРАЦИОННАЯ ЭФФЕКТИВНОСТЬ:
├── Стандартизировать время приготовления (<20 мин)
├── Внедрить мониторинг доставки в реальном времени  
├── Создать систему автоматических уведомлений о сбоях
└── Оптимизировать логистику в дождливые дни

🎯 ПРИОРИТЕТ 2 - МАРКЕТИНГОВАЯ ОПТИМИЗАЦИЯ:
├── Увеличить рекламные бюджеты у ресторанов с ROAS >12x
├── Персонализированные кампании для слабых дней недели
├── Специальные предложения в дождливую погоду  
└── Праздничные промо-кампании (особенно балийские)

🎯 ПРИОРИТЕТ 3 - РАЗВИТИЕ АНАЛИТИКИ:
├── Добавление категоризации по типам кухонь
├── Расширение географической детализации
├── Интеграция дополнительных источников данных
└── Развитие ML-моделей для прогнозирования

💾 ТЕКУЩИЕ ВОЗМОЖНОСТИ СИСТЕМЫ:
├── Детективный анализ падений продаж (с ML и погодой)
├── Анализ 59 ресторанов на 2 платформах
├── 25,129 записей исторических данных (2.5 года)
├── Интеграция с API погоды и праздников
└── Исключение фейковых заказов из анализа

📞 ГОТОВЫЙ ОТВЕТ ДЛЯ ПРЕЗЕНТАЦИИ:
════════════════════════════════════════════════════════════════════════════════
"Система анализирует 59 ресторанов с 25,129 записями за 2.5 года.
Интегрированы данные погоды, праздников, рекламы и операционных метрик.
ML-анализ выявляет причины падения продаж с точностью до конкретных факторов."
════════════════════════════════════════════════════════════════════════════════

✅ Системный анализ завершен!
```

---

## 🛠️ **Разработка**

### **Добавление нового анализатора**

```python
# src/analyzers/custom_analyzer.py
from typing import List, Dict
from .base_analyzer import BaseAnalyzer

class CustomAnalyzer(BaseAnalyzer):
    def analyze(self, restaurant_name: str, start_date: str, end_date: str) -> List[str]:
        # Ваша логика анализа
        return ["Результат анализа"]

# src/analyzers/__init__.py
from .custom_analyzer import CustomAnalyzer
__all__ = ['CustomAnalyzer', ...]
```

### **Тестирование**

```bash
# Запуск тестов
python -m pytest tests/

# Тест конкретного анализатора
python -c "
from src.analyzers import ProfessionalDetectiveAnalyzer
analyzer = ProfessionalDetectiveAnalyzer()
results = analyzer.analyze_sales_performance('Only Eggs', '2025-04-01', '2025-05-31')
print(f'Тест прошел: {len(results)} результатов')
"
```

### **Вклад в проект**

1. Fork репозитория
2. Создайте feature branch (`git checkout -b feature/amazing-feature`)
3. Commit изменения (`git commit -m 'Add amazing feature'`)
4. Push в branch (`git push origin feature/amazing-feature`)
5. Создайте Pull Request

---

## 📞 **Поддержка**

### 🐛 **Сообщить о проблеме**
- [GitHub Issues](https://github.com/muzaquest/bali-food-intelligence/issues)
- Email: support@muzaquest.com

### 💬 **Сообщество**
- [Discord](https://discord.gg/muzaquest)
- [Telegram](https://t.me/muzaquest)

### 📚 **Документация**
- [Wiki](https://github.com/muzaquest/bali-food-intelligence/wiki)
- [API Reference](./docs/api.md)
- [Примеры использования](./docs/examples.md)

---

## 📄 **Лицензия**

Этот проект лицензирован под MIT License - см. файл [LICENSE](LICENSE) для деталей.

---

## 🙏 **Благодарности**

- **Open-Meteo** за погодные данные
- **Grab & Gojek** за возможность интеграции
- **Сообщество разработчиков** за вклад в проект

---

**💎 Создано с любовью для ресторанного бизнеса Бали**

[⬆️ Наверх](#️-bali-food-intelligence)